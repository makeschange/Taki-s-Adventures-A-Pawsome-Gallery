import User from"@/lib/model/userModel";import{authenticateUser}from"@/util/siginToken";import{NextResponse}from"next/server";import connectDB from"@/lib/db";export const POST=async req=>{try{const body=await req.json(),{email:email,password:password}=body;if(!email||!password)return NextResponse.json({message:"Email and Password is required!"},{status:404});await connectDB();const user=await User.findOne({email:email});if(!user)return NextResponse.json({message:"Invalid email!"},{status:404});const isPasswordMatch=await user.comparePassword(password);if(!isPasswordMatch)return NextResponse.json({message:"Password does not match!"},{status:404});const token=await authenticateUser(user._id);return NextResponse.json({message:"Successfully login!",token:token},{status:200})}catch(error){return NextResponse.json({message:"Error",error:error.message},{status:500})}};